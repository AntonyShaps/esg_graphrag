from openai import OpenAI

client = OpenAI(
    base_url="http://localhost:11434/v1",
    api_key="ollama",
)

system_message = ("""You're a Meta company expert, but can only use the provided documents "
    to respond to the questions. You may see some html structures they may represent tables"""
)

user_message = f"""
Use the following documents to answer the question that will follow.
Only use information from these documents; if you don't know, say you don't know.

Documents:
{[doc["text"] for doc in similar_records]}

---

Question: {question}
"""

print("Question:", question)

stream = client.chat.completions.create(
    model="mistral:latest",   # or "mistral" if that's the model name in Ollama
    messages=[
        {"role": "system", "content": system_message},
        {"role": "user", "content": user_message},
    ],
    stream=True,
)

for chunk in stream:
    delta = chunk.choices[0].delta
    if delta and delta.content:
        print(delta.content, end="")
